<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PGR New Starter Roster Creation Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="A professional tool for creating new team member training rosters for PGR at The Star Gold Coast.">
  <meta name="theme-color" content="#1a1a1a" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="data:image/png;base64,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">

  <style>
    /* --- Modern Font: Inter --- */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');

    /* --- CSS Variables & Base Styles --- */
    :root {
      --font-sans: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      --font-serif: 'Cinzel', serif;
      
      --bg-primary: #0e0e0e;
      --bg-secondary: #181818;
      --bg-tertiary: #242424;
      --surface: #1e1e1e;
      --surface-alt: #131313;
      --bg-gradient: radial-gradient(circle at top left, #1c1c1c 0%, #0b0b0b 100%);
      
      --text-primary: #f5f5f5;
      --text-secondary: #a3a3a3;
      --text-muted: #737373;

      --border-primary: #404040;
      --border-secondary: #525252;

      --brand-primary: #B92B27; /* Deep Red */
      --brand-secondary: #D4AF37;/* Rich Gold */
      --brand-gradient: linear-gradient(90deg, var(--brand-primary) 0%, #E74C3C 100%);

      --warn-primary: #f59e0b;
      --ok-primary: #22c55e;

      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;

      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.2), 0 4px 6px -2px rgb(0 0 0 / 0.1);
    }
    *, *::before, *::after { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body { margin: 0; font-family: var(--font-sans); font-size: 14px; line-height: 1.5; color: var(--text-primary); background: var(--bg-gradient); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    .app { display: grid; grid-template-columns: 280px 1fr; min-height: 100vh; }
    .side { position: sticky; top: 0; height: 100vh; padding: 1.5rem; background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%); border-right: 1px solid var(--border-primary); box-shadow: 2px 0 8px rgba(0,0,0,0.4); display: flex; flex-direction: column; gap: 2rem; }
    .main { padding: 2rem; display: grid; gap: 1.5rem; align-content: start; }
    .brand { display: flex; align-items: center; gap: 0.75rem; }
    .logo { width: 180px; height: 180px; border-radius: var(--radius-md); }
    .brand .product h1 { font-family: var(--font-serif); font-size: 1.25rem; font-weight: 700; margin: 0; line-height: 1.2; color: var(--brand-secondary); }
    .brand .product .subbrand { font-size: 0.75rem; color: var(--text-secondary); }
    .nav-group { display: flex; flex-direction: column; gap: 0.5rem; }
    .nav-group h2 { font-family: var(--font-serif); font-size: 0.875rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); margin: 0 0 0.5rem; padding: 0 0.5rem; }
    .nav-chips { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .chip { display: inline-flex; align-items: center; padding: 0.375rem 0.75rem; border-radius: var(--radius-md); background-color: var(--bg-tertiary); border: 1px solid var(--border-primary); font-size: 0.75rem; font-weight: 500; color: var(--text-secondary); }
    .toolbar { position: sticky; top: 0; z-index: 10; display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center; padding: 1rem; margin: -2rem -2rem 0; background: linear-gradient(180deg, rgba(16, 12, 12, 0.95) 70%, transparent 100%); backdrop-filter: blur(8px); border-bottom: 1px solid var(--border-primary); }
    #conflicts { margin-left: auto; font-size: 0.875rem; color: var(--text-secondary); background-color: var(--bg-tertiary); padding: 0.5rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--border-primary); }
    .card { background: linear-gradient(180deg, var(--surface) 0%, var(--surface-alt) 100%); border: 1px solid var(--border-primary); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; }
    .card .hd { display: flex; align-items: center; justify-content: space-between; gap: 1rem; padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-primary); background-color: var(--bg-tertiary); }
    .card .hd h2 { font-family: var(--font-serif); font-size: 1rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; margin: 0; color: var(--text-secondary); }
    .card .hd .sub { font-size: 0.875rem; color: var(--text-muted); }
    .card .bd { padding: 1.5rem; }
    .grid { display: grid; gap: 1rem; }
    .g2 { grid-template-columns: repeat(2, 1fr); }
    .g3 { grid-template-columns: repeat(3, 1fr); }
    .g4 { grid-template-columns: repeat(4, 1fr); }
    label { display: block; font-size: 0.75rem; font-weight: 500; color: var(--text-secondary); margin-bottom: 0.5rem; }
    input, textarea, select { width: 100%; font-family: inherit; font-size: 0.875rem; color: var(--text-primary); background-color: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: var(--radius-md); padding: 0.625rem 0.75rem; transition: border-color 0.2s, box-shadow 0.2s; }
    input:focus, textarea:focus, select:focus { outline: none; border-color: var(--brand-primary); box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--brand-primary); }
    textarea { min-height: 160px; resize: vertical; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; font-family: inherit; font-size: 0.875rem; font-weight: 600; padding: 0.625rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--border-secondary); background-color: var(--bg-tertiary); color: var(--text-primary); cursor: pointer; transition: all 0.15s ease-in-out; user-select: none; }
    .btn:hover { background-color: #374151; border-color: #4b5563; }
    .btn:active { transform: scale(0.98); }
    .btn:focus-visible { outline: none; box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--brand-primary); }
    .btn .ico { width: 16px; height: 16px; }
    .btn.primary { background-image: var(--brand-gradient); border: none; color: white; box-shadow: var(--shadow-md); }
    .btn.primary:hover { filter: brightness(1.1); }
    .btn.warn { background-color: #422006; border-color: #78350f; color: var(--warn-primary); }
    .btn.warn:hover { background-color: #522a08; }
    .btn.ghost { background-color: transparent; border-color: transparent; color: var(--text-secondary); }
    .btn.ghost:hover { background-color: var(--bg-tertiary); color: var(--text-primary); }
    .table-wrapper { overflow: auto; border: 1px solid var(--border-primary); border-radius: var(--radius-lg); }
    table { width: 100%; border-collapse: collapse; font-size: 0.875rem; }
    th, td { padding: 0.75rem 1rem; text-align: left; border-bottom: 1px solid var(--border-primary); white-space: nowrap; }
    thead th { position: sticky; top: 0; background-color: var(--bg-tertiary); font-weight: 600; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); z-index: 2; }
    tbody tr:last-child td { border-bottom: none; }
    tbody tr:hover { background-color: #2c2c2c; }
    .group-row td { position: sticky; top: 48px; background-color: #222222; font-weight: 700; color: var(--brand-secondary); z-index: 1; }
    .visually-hidden { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px); }
    .mt-4 { margin-top: 1rem; }
    .modal-overlay { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(4px); z-index: 50; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; }
    .modal-overlay.visible { opacity: 1; visibility: visible; }
    .modal-content { background-color: var(--surface); border-radius: var(--radius-lg); border: 1px solid var(--border-primary); box-shadow: var(--shadow-lg); padding: 2rem; width: 100%; max-width: 400px; transform: scale(0.95); transition: transform 0.3s; }
    .modal-overlay.visible .modal-content { transform: scale(1); }
    .modal-content h3 { font-family: var(--font-serif); margin: 0 0 0.5rem; font-size: 1.25rem; font-weight: 700; color: var(--brand-secondary); }
    .modal-content p { margin: 0 0 1.5rem; color: var(--text-secondary); }
    .modal-actions { display: flex; justify-content: flex-end; gap: 0.75rem; }
    #calendar-modal .modal-content { max-width: 340px; }
    .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
    .calendar-day, .calendar-weekday { display: flex; align-items: center; justify-content: center; height: 36px; border-radius: var(--radius-md); }
    .calendar-weekday { font-size: 0.75rem; font-weight: 600; color: var(--text-muted); }
    .calendar-day:not(.empty) { cursor: pointer; transition: background-color 0.2s; }
    .calendar-day:not(.empty):hover { background-color: var(--bg-tertiary); }
    .calendar-day.blackout { background-color: var(--brand-primary); color: var(--text-primary); font-weight: 600; }
    @media (max-width: 1024px) { .app { grid-template-columns: 1fr; } .side { position: static; height: auto; border-right: none; border-bottom: 1px solid var(--border-primary); } .toolbar { margin: -2rem -2rem 0; } }
    @media (max-width: 768px) { .main { padding: 1.5rem; } .toolbar { margin: -1.5rem -1.5rem 0; } .g2, .g3, .g4 { grid-template-columns: 1fr; } .card .hd { flex-direction: column; align-items: flex-start; gap: 0.25rem; } }
  </style>
</head>
<body>

<div class="app">
  <aside class="side">
    <div class="brand">
      <img src="data:image/png;base64,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" alt="PGR Logo" class="logo">
      <div class="product">
        <h1>PGR New Starter Roster Creation Tool</h1>
        <div class="subbrand">Private Gaming Rooms</div>
        <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">Created by Patrick Price 2025</div>
        <div style="font-size: 10px; color: var(--text-muted); margin-top: 2px;">Version 7.0</div>
      </div>
    </div>
    <div class="nav-group">
      <h2>Roster Rules</h2>
      <div class="nav-chips"><div class="chip">One shift/day</div><div class="chip">No Sundays</div><div class="chip">Mon off</div><div class="chip">Min 15 shifts</div><div class="chip">≥2 off / 10d</div><div class="chip">Capacity 1/day/outlet</div></div>
    </div>
  </aside>

  <main class="main">
    <div class="toolbar" role="region" aria-label="Global actions">
      <button id="buildAll" class="btn primary" type="button"><svg class="ico" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>Build Roster</button>
      <button id="clearRosterBtn" class="btn" type="button">Clear Roster</button>
      <button id="exportAllCsv" class="btn" type="button"><svg class="ico" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>Export CSV</button>
      <button id="exportAllXls" class="btn" type="button"><svg class="ico" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z"/></svg>Export Excel</button>
      <span id="conflicts" aria-live="polite">—</span>
    </div>

    <section class="card" aria-labelledby="starters-h">
      <div class="hd"><h2 id="starters-h">Step 1: Add New Team Members</h2><span class="sub">Add manually or import a CSV file</span></div>
      <div class="bd">
        <div class="grid g3">
          <div><label for="stName">Full Name</label><input id="stName" placeholder="Dakota Parata"></div>
          <div><label for="stId">Staff ID</label><input id="stId" placeholder="123456"></div>
          <div><label for="stDate">First Day of Work</label><input id="stDate" type="date"></div>
        </div>
        <div class="grid g4 mt-4">
          <button id="addStarter" class="btn primary" type="button">Add Person</button>
          <button id="importStartersBtn" class="btn" type="button">Import from CSV</button>
          <button id="exportStartersBtn" class="btn" type="button">Export to CSV</button>
          <button id="clearStarters" class="btn" type="button">Clear All People</button>
          <input type="file" id="importStarters" accept=".csv" class="visually-hidden" />
        </div>
        <div class="mt-4 table-wrapper">
          <table id="startersTbl">
            <thead><tr><th>#</th><th>Name</th><th>Staff ID</th><th>Start Date</th><th>Days Off</th><th>Actions</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="card" aria-labelledby="blocks-h">
      <div class="hd"><h2 id="blocks-h">Step 2: Set Training Shifts</h2><span class="sub">Set how many training shifts each person gets per area</span></div>
      <div class="bd">
        <div class="grid g3">
          <div><label for="blk_food">Oasis Food</label><input type="number" id="blk_food" value="3" min="0"></div>
          <div><label for="blk_obar">Oasis Bar</label><input type="number" id="blk_obar" value="2" min="0"></div>
          <div><label for="blk_floor">SOV South Floor</label><input type="number" id="blk_floor" value="3" min="0" title="Minimum 3 in a row enforced"></div>
          <div><label for="blk_nfloor">SOV North Floor</label><input type="number" id="blk_nfloor" value="1" min="0"></div>
          <div><label for="blk_bar">SOV South Bar</label><input type="number" id="blk_bar" value="1" min="0"></div>
          <div><label for="blk_dining">SOV Dining</label><input type="number" id="blk_dining" value="4" min="0"></div>
        </div>
        <div class="mt-4">
          <label>Randomize Shift Order?</label>
          <button id="shuffleBlocks" class="btn" type="button">Shuffle: OFF</button>
        </div>
      </div>
    </section>

    <section class="card" aria-labelledby="mandatory-h">
      <div class="hd"><h2 id="mandatory-h">Step 3: Session Days</h2><span class="sub">Choose days for mandatory sessions</span></div>
      <div class="bd">
        <div class="grid g2">
          <div><label for="welcomeDaySel">Welcome Day</label><select id="welcomeDaySel"><option value="1">Monday</option><option value="2" selected>Tuesday</option><option value="3">Wednesday</option><option value="4">Thursday</option><option value="5">Friday</option><option value="6">Saturday</option></select></div>
          <div><label for="onboardDaySel">PGR Onboarding</label><select id="onboardDaySel"><option value="1">Monday</option><option value="2">Tuesday</option><option value="3" selected>Wednesday</option><option value="4">Thursday</option><option value="5">Friday</option><option value="6">Saturday</option></select></div>
        </div>
      </div>
    </section>

    <section class="card" aria-labelledby="schedule-h">
      <div class="hd"><h2 id="schedule-h">Step 4: Generated Roster</h2><span class="sub">Click "Build Roster" to see the results here</span></div>
      <div class="bd" style="padding: 0;">
        <div class="table-wrapper">
          <table id="schedTbl">
            <thead><tr><th>Team Member</th><th>Staff ID</th><th>Date</th><th>Start</th><th>End</th><th>Outlet</th><th>Shift #</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- Modals -->
<div id="modal" class="modal-overlay"><div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modal-title"><h3 id="modal-title"></h3><p id="modal-text"></p><div class="modal-actions"><button id="modal-cancel" class="btn">Cancel</button><button id="modal-confirm" class="btn primary">Confirm</button></div></div></div>
<div id="calendar-modal" class="modal-overlay"><div class="modal-content"><div class="calendar-header"><button id="prev-month" class="btn ghost">&lt;</button><h3 id="calendar-title"></h3><button id="next-month" class="btn ghost">&gt;</button></div><div class="calendar-grid" id="calendar-weekdays"></div><div class="calendar-grid" id="calendar-days"></div><div class="modal-actions" style="margin-top: 1rem;"><button id="calendar-close" class="btn primary">Done</button></div></div></div>

<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</body>
<script>
// --- APP INITIALIZATION ---
window.onload = () => {
    // --- GLOBAL VARIABLES & CONSTANTS ---
    let starters = [];
    let allRows = [];
    let shuffle = false;
    let modalResolve;
    let activeStarterIndex = -1;
    let currentCalendarDate = new Date();

    const MIN_SHIFTS = 15;
    const MANDATORY_SESSIONS = [
        { name: 'Welcome Day', label: 'Welcome Day', start: '09:00' },
        { name: 'PGR F&B On boarding', label: 'PGR F&B On boarding', start: '09:00' }
    ];
    const RULES = {
        "Oasis Food": ["08:00", "11:00", "16:00"],
        "Oasis Bar": ["06:00", "08:00", "10:00", "14:00", "16:00", "17:00", "18:00", "19:00", "22:00"],
        "SOV South Floor": Array.from({ length: 14 }, (_, k) => (9 + k).toString().padStart(2, '0') + ":00"),
        "SOV North Floor": ["18:00"],
        "SOV South Bar": ["06:00", "10:00", "14:00", "18:00", "22:00"],
        "SOV Dining": ["17:00"]
    };
    
    // --- HELPER FUNCTIONS ---
    const byId = id => document.getElementById(id);
    const pad2 = n => (n < 10 ? "0" : "") + n;
    const toYMD = d => `${d.getFullYear()}-${pad2(d.getMonth() + 1)}-${pad2(d.getDate())}`;
    const toDMY = d => `${pad2(d.getDate())}/${pad2(d.getMonth() + 1)}/${d.getFullYear()}`;
    const parseYMD = s => { const [y, m, d] = s.split('-').map(Number); return new Date(y, m - 1, d); };
    const isMon = d => d.getDay() === 1;
    const isSun = d => d.getDay() === 0;
    const nextWorking = d => { let x = new Date(d); while (isSun(x) || isMon(x)) x.setDate(x.getDate() + 1); return x; };
    function addWorkDay(d) { const x = new Date(d); x.setDate(x.getDate() + 1); return nextWorking(x); }
    function nextDow(startDate, dow, includeStart = true) { const d = new Date(startDate); if (!includeStart) d.setDate(d.getDate() + 1); while (d.getDay() !== dow) d.setDate(d.getDate() + 1); return d; }
    function shuffled(arr) { const a = arr.slice(); for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[a[i], a[j]] = [a[j], a[i]]; } return a; }
    function isOutletAllowedOnDate(outlet, dateObj) { const dow = dateObj.getDay(); if (dow === 0) return false; if (outlet === "SOV North Floor") return (dow === 5 || dow === 6); return true; }

    // --- MODAL FUNCTIONS ---
    function showModal(title, text, showCancel = false) {
        const modal = byId('modal');
        byId('modal-title').textContent = title;
        byId('modal-text').textContent = text;
        byId('modal-cancel').style.display = showCancel ? 'inline-flex' : 'none';
        modal.classList.add('visible');
        return new Promise(resolve => { modalResolve = resolve; });
    }

    // --- CORE ROSTERING FUNCTIONS ---
    function isMandatory(r) { return r.Outlet === MANDATORY_SESSIONS[0].label || r.Outlet === MANDATORY_SESSIONS[1].label; }
    function shiftsInLastNDaysFor(starterName, dateObj, n) {
        const start = new Date(dateObj); start.setDate(start.getDate() - (n - 1));
        const startKey = toYMD(start), endKey = toYMD(dateObj);
        let count = 0;
        for (const r of allRows) {
            if (r.Starter !== starterName) continue;
            if (isMandatory(r)) continue;
            if (r.Date >= startKey && r.Date <= endKey) count++;
        }
        return count;
    }
    function canWorkThisDay(starterName, dateObj) { return shiftsInLastNDaysFor(starterName, dateObj, 10) < 8; }

    // --- CALENDAR FUNCTIONS ---
    function renderCalendar() {
        const calendarTitle = byId('calendar-title');
        const calendarDays = byId('calendar-days');
        const weekdaysContainer = byId('calendar-weekdays');
        const year = currentCalendarDate.getFullYear();
        const month = currentCalendarDate.getMonth();
        calendarTitle.textContent = `${currentCalendarDate.toLocaleString('default', { month: 'long' })} ${year}`;
        calendarDays.innerHTML = '';
        weekdaysContainer.innerHTML = ['S', 'M', 'T', 'W', 'T', 'F', 'S'].map(d => `<div class="calendar-weekday">${d}</div>`).join('');
        const firstDayOfMonth = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const starter = starters[activeStarterIndex];
        if (!starter) return;
        for (let i = 0; i < firstDayOfMonth; i++) { calendarDays.innerHTML += `<div class="calendar-day empty"></div>`; }
        for (let i = 1; i <= daysInMonth; i++) {
            const dayEl = document.createElement('div');
            dayEl.className = 'calendar-day';
            dayEl.textContent = i;
            const dateStr = toYMD(new Date(year, month, i));
            if (starter.blackoutDates.includes(dateStr)) { dayEl.classList.add('blackout'); }
            dayEl.onclick = () => {
                const index = starter.blackoutDates.indexOf(dateStr);
                if (index > -1) { starter.blackoutDates.splice(index, 1); } else { starter.blackoutDates.push(dateStr); }
                renderStarters();
                dayEl.classList.toggle('blackout');
            };
            calendarDays.appendChild(dayEl);
        }
    }

    // --- STARTER MANAGEMENT ---
    function renderStarters() {
        const tb = document.querySelector('#startersTbl tbody');
        if (starters.length === 0) { tb.innerHTML = `<tr><td colspan="6" style="text-align:center; color: var(--text-muted); padding: 2rem;">No starters added yet.</td></tr>`; return; }
        tb.innerHTML = starters.map((s, i) => `<tr><td>${i + 1}</td><td>${s.Name}</td><td>${s.StaffID || 'N/A'}</td><td>${toDMY(parseYMD(s.StartDate))}</td><td>${s.blackoutDates.length} day(s)</td><td style="text-align:right"><button data-i='${i}' class='btn ghost open-calendar' type="button">Calendar</button><button data-i='${i}' class='btn ghost remove-starter' type="button">Remove</button></td></tr>`).join('');
        tb.querySelectorAll('.remove-starter').forEach(b => b.onclick = async () => { const confirmed = await showModal('Confirm Removal', `Are you sure you want to remove ${starters[+b.dataset.i].Name}?`, true); if (confirmed) { starters.splice(+b.dataset.i, 1); renderStarters(); } });
        tb.querySelectorAll('.open-calendar').forEach(b => b.onclick = () => { activeStarterIndex = +b.dataset.i; currentCalendarDate = parseYMD(starters[activeStarterIndex].StartDate); renderCalendar(); byId('calendar-modal').classList.add('visible'); });
    }
    function addStarter() {
        const Name = byId('stName').value.trim(); const StaffID = byId('stId').value.trim(); const StartDate = byId('stDate').value;
        if (!Name || !StartDate) { showModal('Missing Information', 'Both Name and Start Date are required.'); return; }
        starters.push({ Name, StaffID, StartDate, blackoutDates: [] });
        renderStarters();
        byId('stName').value = ''; byId('stId').value = ''; byId('stDate').value = '';
    }
    async function clearStarters() { if (starters.length === 0) { showModal('No Starters', 'There are no starters to clear.'); return; } const confirmed = await showModal('Confirm Clear', 'Are you sure?', true); if (confirmed) { starters = []; renderStarters(); } }
    function importStarters(e) { 
        const f = e.target.files[0]; 
        if (!f) return; 
        const fr = new FileReader(); 
        fr.onload = () => { 
            const lines = fr.result.split(/\r?\n/).filter(Boolean); 
            lines.shift(); 
            starters = lines.map(l => { const [Name, StaffID, StartDate] = l.split(','); return { Name, StaffID, StartDate, blackoutDates: [] }; }); 
            renderStarters(); 
        }; 
        fr.readAsText(f);
        e.target.value = null;
    }
    function exportStarters() {
        if (starters.length === 0) { showModal('No Starters', 'There are no starters to export.'); return; }
        const header = ['Name', 'StaffID', 'StartDate'];
        const csv = [header.join(',')].concat(starters.map(s => [s.Name, s.StaffID || '', s.StartDate].join(','))).join('\n');
        download('starters.csv', csv);
    }
    function download(name, text) { const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([text], { type: 'text/plain' })); a.download = name; a.click(); }

    // --- BUILDER & RENDER LOGIC ---
    async function buildAll() {
        if (allRows.length > 0) {
            const confirmed = await showModal('Roster Exists', 'A schedule already exists. Do you want to replace it?', true);
            if (!confirmed) return;
        }
        if (!starters.length) { showModal('Build Error', 'Add at least one starter.'); return; }
        
        allRows = []; 
        const placedByStarter = new Map(); 
        const placedByStarterOutlet = new Map();
        
        function incPlaced(starterName, outlet) { placedByStarter.set(starterName, (placedByStarter.get(starterName) || 0) + 1); if (!placedByStarterOutlet.has(starterName)) placedByStarterOutlet.set(starterName, new Map()); const m = placedByStarterOutlet.get(starterName); m.set(outlet, (m.get(outlet) || 0) + 1); }
        function getPlaced(starterName) { return placedByStarter.get(starterName) || 0; }
        function getPlacedOutlet(starterName, outlet) { return placedByStarterOutlet.get(starterName)?.get(outlet) || 0; }
        function addRow(r) { allRows.push(r); incPlaced(r.Starter, r.Outlet); }

        const used = new Set();
        const welcomeDow = +byId('welcomeDaySel').value;
        const onboardDow = +byId('onboardDaySel').value;
        const norm = starters.map(s => { let d = parseYMD(s.StartDate); while (isSun(d)) d.setDate(d.getDate() + 1); return { ...s, NormStart: d }; });
        const groups = {}; for (const s of norm) { const k = toYMD(s.NormStart); (groups[k] ||= []).push(s); }
        for (const dayKey of Object.keys(groups).sort()) {
            let day1 = nextDow(parseYMD(dayKey), welcomeDow);
            let day2 = nextDow(day1, onboardDow, false);
            for (const s of groups[dayKey]) {
                addRow(makeRow(s, day1, MANDATORY_SESSIONS[0].start, MANDATORY_SESSIONS[0].label, 1));
                addRow(makeRow(s, day2, MANDATORY_SESSIONS[1].start, MANDATORY_SESSIONS[1].label, 2));
                s.__state = { currentOutlet: null, remaining: 0, nextDate: addWorkDay(day2) };
            }
        }
        const baseCounts = getBlocks().reduce((m, b) => (m[b.outlet] = b.count, m), {});
        let progress = true, safety = 0; const everyone = Object.values(groups).flat();
        while (progress && safety < 5000) {
            progress = false; safety++;
            for (const s of everyone) {
                if (getPlaced(s.Name) >= MIN_SHIFTS) { s.__state = null; continue; }
                if (!s.__state) continue;
                let st = s.__state; let cur = nextWorking(st.nextDate); let curKey = toYMD(cur);
                let outlet = st.currentOutlet;
                if (st.remaining <= 0) {
                    let candidates = Object.keys(baseCounts).filter(o => getPlacedOutlet(s.Name, o) < baseCounts[o]);
                    if (!candidates.length) { s.__state = null; continue; }
                    if (shuffle) candidates = shuffled(candidates);
                    const allowedToday = candidates.filter(o => !used.has(curKey + "|" + o) && isOutletAllowedOnDate(o, cur));
                    outlet = allowedToday[0] || (shuffle ? shuffled(candidates)[0] : candidates[0]);
                    st.currentOutlet = outlet;
                    st.remaining = Math.max(0, baseCounts[outlet] - getPlacedOutlet(s.Name, outlet));
                }
                while (s.blackoutDates.includes(curKey) || used.has(curKey + "|" + outlet) || !isOutletAllowedOnDate(outlet, cur) || !canWorkThisDay(s.Name, cur)) { cur = addWorkDay(cur); curKey = toYMD(cur); if (++safety > 5000) break; }
                const t = pickTime(outlet, allRows.length);
                addRow(makeRow(s, cur, t, outlet, getPlaced(s.Name) + 1));
                used.add(curKey + "|" + outlet);
                st.remaining -= 1; st.nextDate = addWorkDay(cur); progress = true;
            }
        }
        for (const s of everyone) {
            let placed = getPlaced(s.Name); if (placed >= MIN_SHIFTS) continue;
            let last = allRows.filter(r => r.Starter === s.Name).map(r => r.Date).sort().pop();
            let cur = last ? addWorkDay(parseYMD(last)) : nextWorking(s.NormStart);
            let rot = 0, guard = 0; const PREF = ["SOV South Floor", "SOV South Bar", "Oasis Food", "Oasis Bar", "SOV North Floor", "SOV Dining"];
            while (placed < MIN_SHIFTS && guard < 5000) {
                guard++; const key = toYMD(cur);
                if (s.blackoutDates.includes(key)) { cur = addWorkDay(cur); continue; }
                let outlet = PREF.find(o => !used.has(key + "|" + o) && isOutletAllowedOnDate(o, cur));
                if (!outlet || !canWorkThisDay(s.Name, cur)) { cur = addWorkDay(cur); continue; }
                const t = pickTime(outlet, rot++);
                addRow(makeRow(s, cur, t, outlet, getPlaced(s.Name) + 1));
                used.add(key + "|" + outlet); placed++; cur = addWorkDay(cur);
            }
        }
        allRows.sort((a, b) => a.Starter.localeCompare(b.Starter) || a.Date.localeCompare(b.Date) || a.Start.localeCompare(b.Start));
        byId('conflicts').textContent = `Built ${allRows.length} shifts for ${starters.length} starter(s)`;
        renderSched(allRows);
    }
    async function clearRoster() {
        if (allRows.length === 0) {
            showModal('Roster Empty', 'There is no schedule to clear.');
            return;
        }
        const confirmed = await showModal('Clear Roster', 'Are you sure you want to clear the entire generated schedule?', true);
        if (confirmed) {
            allRows = [];
            renderSched([]);
            byId('conflicts').textContent = '—';
        }
    }
    function renderSched(rows) {
        const tb = document.querySelector('#schedTbl tbody'); tb.innerHTML = '';
        if (rows.length === 0) { tb.innerHTML = `<tr><td colspan="7" style="text-align:center; color: var(--text-muted); padding: 2rem;">No schedule generated yet.</td></tr>`; return; }
        let curStarter = null;
        for (const r of rows) {
            if (r.Starter !== curStarter) {
                curStarter = r.Starter;
                const trHead = document.createElement('tr'); trHead.className = 'group-row';
                trHead.innerHTML = `<td colspan="7"><b>${r.Starter}</b> &nbsp;&middot;&nbsp; <span class="text-muted">StaffID: ${r.StaffID || 'N/A'}</span></td>`;
                tb.appendChild(trHead);
            }
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${r.Starter}</td><td>${r.StaffID || 'N/A'}</td><td>${toDMY(parseYMD(r.Date))}</td><td>${r.Start}</td><td>${r.End}</td><td>${r.Outlet}</td><td>${r.Step}</td>`;
            tb.appendChild(tr);
        }
    }
    function getBlocks() { return [{ outlet: "Oasis Food", count: Math.max(0, +byId('blk_food').value || 0) }, { outlet: "Oasis Bar", count: Math.max(0, +byId('blk_obar').value || 0) }, { outlet: "SOV South Floor", count: Math.max(3, +byId('blk_floor').value || 0) }, { outlet: "SOV North Floor", count: Math.max(0, +byId('blk_nfloor').value || 0) }, { outlet: "SOV South Bar", count: Math.max(0, +byId('blk_bar').value || 0) }, { outlet: "SOV Dining", count: Math.max(0, +byId('blk_dining').value || 0) }]; }
    function makeRow(starter, dateObj, start, outlet, step) { const [hh, mm] = start.split(":").map(Number); const endH = (hh + 5) % 24, endM = mm; return { Starter: starter.Name, StaffID: starter.StaffID || '', Date: toYMD(dateObj), Start: start, End: pad2(endH) + ":" + pad2(endM), Outlet: outlet, Step: step, Shift: start.replace(":", "") + "-" + pad2(endH) + pad2(endM) + " " + outlet + " TRN" }; }
    function pickTime(outlet, i) { const times = RULES[outlet] || ["09:00"]; return times[i % times.length]; }
    
    // --- ATTACH EVENT LISTENERS ---
    byId('modal-cancel').onclick = () => { byId('modal').classList.remove('visible'); if (modalResolve) modalResolve(false); };
    byId('modal-confirm').onclick = () => { byId('modal').classList.remove('visible'); if (modalResolve) modalResolve(true); };
    byId('modal').onclick = (e) => { if (e.target === byId('modal')) { byId('modal').classList.remove('visible'); if (modalResolve) modalResolve(false); } };
    byId('prev-month').onclick = () => { currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1); renderCalendar(); };
    byId('next-month').onclick = () => { currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1); renderCalendar(); };
    byId('calendar-close').onclick = () => byId('calendar-modal').classList.remove('visible');
    byId('calendar-modal').onclick = (e) => { if (e.target === byId('calendar-modal')) byId('calendar-modal').classList.remove('visible'); };
    byId('addStarter').onclick = addStarter;
    byId('clearStarters').onclick = clearStarters;
    byId('importStartersBtn').onclick = () => byId('importStarters').click();
    byId('importStarters').onchange = importStarters;
    byId('exportStartersBtn').onclick = exportStarters;
    byId('shuffleBlocks').onclick = () => {
        shuffle = !shuffle;
        const btn = byId('shuffleBlocks');
        btn.textContent = 'Shuffle: ' + (shuffle ? 'ON' : 'OFF');
        btn.style.borderColor = shuffle ? 'var(--brand-secondary)' : 'var(--border-secondary)';
    };
    byId('buildAll').onclick = buildAll;
    byId('clearRosterBtn').onclick = clearRoster;
    byId('exportAllCsv').onclick = () => { if (!allRows.length) { showModal('Export Error', 'Build a schedule first.'); return; } const header = ['Starter', 'StaffID', 'Date', 'Start', 'End', 'Outlet', 'Step', 'Shift']; const csv = [header.join(',')].concat(allRows.map(r => [r.Starter, r.StaffID || '', toDMY(parseYMD(r.Date)), r.Start, r.End, r.Outlet, r.Step, r.Shift].join(','))).join('\n'); download('schedules.csv', csv); };
    byId('exportAllXls').onclick = () => { if (!allRows.length) { showModal('Export Error', 'Build a schedule first.'); return; } const wsSchedule = XLSX.utils.json_to_sheet(allRows.map(r => ({ Starter: r.Starter, StaffID: r.StaffID || '', Date: toDMY(parseYMD(r.Date)), Start: r.Start, End: r.End, Outlet: r.Outlet, Step: r.Step, Shift: r.Shift }))); const wsStarters = XLSX.utils.json_to_sheet(starters.map(s => ({ Name: s.Name, StaffID: s.StaffID || '', StartDate: s.StartDate }))); const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, wsSchedule, "Roster"); XLSX.utils.book_append_sheet(wb, wsStarters, "Starters"); XLSX.writeFile(wb, "roster_and_starters.xlsx"); };

    // --- INITIAL SETUP ---
    renderStarters();
    renderSched([]);
};

/* --- PWA: register service worker --- */
if("serviceWorker" in navigator && window.location.protocol === 'https:') {
  navigator.serviceWorker.register('sw.js').catch(error => {
    console.warn('Service Worker registration failed:', error);
  });
}
</script>
</html>
